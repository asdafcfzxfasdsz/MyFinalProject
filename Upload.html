<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>Upload & Comments</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        /* ä¸ºäº†å¤ç°å›¾ç‰‡æ•ˆæœï¼Œè¡¥å……å¿…è¦çš„ CSS */
        body {
            background-color: #f2fbf2; /* å›¾ç‰‡ä¸­éå¸¸æ·¡çš„èƒŒæ™¯è‰² */
            margin: 0;
            font-family: Arial, sans-serif;
            color: #333;
        }

        /* --- å¯¼èˆªæ ä¿®æ­£ï¼šä½¿ç”¨css/style.cssä¸­çš„æ ·å¼ --- */
        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #84F318; /* ä½¿ç”¨CSSå˜é‡ä¸­çš„primary-green */
            padding: 15px 40px; /* ä½¿ç”¨CSSæ–‡ä»¶ä¸­çš„å€¼ */
            position: sticky;
            top: 0;
            z-index: 1000;
            margin: 0; /* ç§»é™¤è‡ªå®šä¹‰å¤–è¾¹è·ï¼Œä½¿ç”¨CSSæ–‡ä»¶ä¸­çš„æ ·å¼ */
            border-radius: 0; /* ç§»é™¤åœ†è§’ï¼Œä½¿ç”¨CSSæ–‡ä»¶ä¸­çš„æ ·å¼ */
            box-shadow: none; /* ç§»é™¤é˜´å½±ï¼Œä½¿ç”¨CSSæ–‡ä»¶ä¸­çš„æ ·å¼ */
        }

        .nav-links {
            display: flex;
            gap: 30px;
            font-weight: bold;
            font-size: 16px; /* ä½¿ç”¨CSSæ–‡ä»¶ä¸­çš„å€¼ */
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .nav-links a {
            text-decoration: none;
            color: #333333; /* ä½¿ç”¨CSSå˜é‡ä¸­çš„text-dark */
            font-size: 16px; /* ä½¿ç”¨CSSæ–‡ä»¶ä¸­çš„å€¼ */
            font-weight: bold; /* ä½¿ç”¨CSSæ–‡ä»¶ä¸­çš„å€¼ */
        }

        .nav-links li a:hover,
        .nav-links li a.active {
            color: #FF0000; /* ä½¿ç”¨CSSå˜é‡ä¸­çš„active-red */
            text-decoration: underline;
            text-underline-offset: 5px;
        }

        /* Ticket çº¢è‰²é«˜äº® - ä¿®æ”¹ä¸ºç¬¬5ä¸ªèœå•é¡¹ */
        .nav-links li:nth-child(5) a {
            color: #FF0000; /* ä½¿ç”¨CSSå˜é‡ä¸­çš„active-red */
            font-size: 16px;
            font-weight: bold;
        }

        /* ===== Override: on this page, only .active should be highlighted ===== */
        .nav-links li:nth-child(5) a {
            color: #333333;
            text-decoration: none;
        }

        /* ===== Same as Travel: active nav bounce + bigger ===== */
        .nav-links a.active{
            display: inline-block;
            transform: translateY(-6px) scale(1.15);
            font-weight: 700;
            animation: navPop 450ms ease-out;
            transition: transform 220ms ease, font-weight 220ms ease;
        }
        @keyframes navPop{
            0%{ transform: translateY(0) scale(1); }
            60%{ transform: translateY(-12px) scale(1.25); }
            100%{ transform: translateY(-6px) scale(1.15); }
        }

        .nav-right {
            display: flex;
            align-items: center;
            gap: 20px; /* ä½¿ç”¨CSSæ–‡ä»¶ä¸­çš„å€¼ */
        }

        .search-bar {
            background: white;
            border-radius: 20px;
            padding: 5px 15px;
            display: flex;
            align-items: center;
            width: 250px; /* ä½¿ç”¨CSSæ–‡ä»¶ä¸­çš„å€¼ */
            position: relative;
        }

        .search-bar input {
            border: none;
            outline: none;
            width: 100%;
            margin-left: 10px; /* ä½¿ç”¨CSSæ–‡ä»¶ä¸­çš„å€¼ */
            font-size: 14px;
            color: #666;
        }

        .user-avatar {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
            font-weight: 600;
            color: #333333; /* ä½¿ç”¨CSSå˜é‡ä¸­çš„text-dark */

            /* ===== Same as Travel: clickable + truncate ===== */
            cursor: pointer;
            max-width: 140px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .tag-icon {
            font-size: 18px;
        }

        /* --- è‹±é›„åŒºåŸŸå¸ƒå±€ --- */
        .hero-section {
            max-width: 1200px;
            margin: 20px auto;
            display: flex;
            gap: 20px;
            padding: 0 20px;
            overflow-x: auto;
        }

        /* ä¿®æ”¹ï¼šå°† .hero-card è®¾ä¸º flex item å¹¶ä¸”æ˜¯é“¾æ¥æ—¶çš„æ ·å¼ */
        a.hero-card, .hero-card {
            flex: 1;
            min-width: 300px;
            height: 200px;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            display: block; /* ç¡®ä¿aæ ‡ç­¾ä½œä¸ºå—çº§å…ƒç´  */
            transition: transform 0.3s ease, box-shadow 0.3s ease; /* æ·»åŠ è¿‡æ¸¡åŠ¨ç”» */
        }

        /* é¼ æ ‡æ‚¬åœç‰¹æ•ˆï¼šä¸Šæµ® + é˜´å½± */
        a.hero-card:hover, .hero-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        .hero-card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        .hero-text {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            background: rgba(255, 255, 255, 0.9);
            padding: 10px;
            font-size: 14px;
            color: #333333; /* ä½¿ç”¨CSSå˜é‡ä¸­çš„text-dark */
        }

        .hero-text h3 {
            margin: 0 0 5px 0;
            font-size: 16px;
            font-weight: bold;
        }

        .hero-text p {
            margin: 0;
            font-size: 12px;
            color: #666666; /* ä½¿ç”¨CSSå˜é‡ä¸­çš„text-light */
        }

        /* --- ä¸­é—´å†…å®¹åŒºåŸŸå¸ƒå±€ --- */
        .upload-layout {
            display: flex;
            max-width: 1200px;
            margin: 20px auto;
            padding: 0 20px;
            gap: 30px;
        }

        .comments-section, .instagram-section {
            flex: 1;
            background: #fff; /* ä¸é€æ˜ç™½è‰²èƒŒæ™¯ */
            border-radius: 15px; /* å¤§åœ†è§’ */
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.03); /* è½»å¾®é˜´å½± */
        }

        .section-title {
            margin-top: 0;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            font-size: 18px;
            color: #444;
        }

        .section-title::before {
            content: '';
            width: 4px;
            height: 18px;
            background: #e63946; /* æ ‡é¢˜çº¢ç«–çº¿ */
            margin-right: 10px;
            border-radius: 2px;
        }

        /* ===== New: make section title link look the same ===== */
        .section-title a{
            color: inherit;
            text-decoration: none;
            cursor: pointer;
        }
        .section-title a:hover{
            text-decoration: underline;
            text-underline-offset: 4px;
        }

        /* ===== New: comment upload UI ===== */
        .comment-form {
            background: rgba(0,0,0,0.02);
            border: 1px solid rgba(0,0,0,0.08);
            border-radius: 14px;
            padding: 14px;
            margin-bottom: 18px;
        }
        .comment-form textarea{
            width: 100%;
            min-height: 90px;
            resize: vertical;
            border: 1px solid rgba(0,0,0,0.14);
            border-radius: 12px;
            padding: 10px 12px;
            outline: none;
            font-size: 14px;
            box-sizing: border-box;
        }
        .comment-form textarea:focus{
            border-color: rgba(230,57,70,0.55);
            box-shadow: 0 0 0 3px rgba(230,57,70,0.12);
        }
        .comment-row{
            display:flex;
            align-items:center;
            justify-content: space-between;
            gap: 12px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        .comment-row input[type="file"]{
            font-size: 13px;
        }
        .comment-btn{
            border: none;
            cursor: pointer;
            border-radius: 999px;
            padding: 10px 14px;
            font-weight: 800;
            background: #e63946;
            color: #fff;
        }
        .comment-hint{
            margin-top: 10px;
            font-size: 12px;
            color: rgba(230,57,70,0.9);
            display: none;
        }
        .comment-preview{
            margin-top: 10px;
            display: none;
        }
        .comment-preview img{
            width: 100%;
            max-height: 220px;
            object-fit: cover;
            border-radius: 12px;
            display:block;
        }

        /* Insta Grid */
        .insta-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .insta-item {
            border-radius: 12px;
            overflow: hidden;
            aspect-ratio: 1;
            display: block; /* ç¡®ä¿é“¾æ¥ä¹Ÿæ˜¯å—çº§æ˜¾ç¤º */
        }

        .insta-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
            transition: transform 0.3s ease;
        }

        .insta-item:hover img {
            transform: scale(1.1);
        }

        /* --- æ–°å¢ï¼šFooter æ ·å¼ --- */
        .footer-wrapper {
            margin-top: 40px;
        }

        .footer-main {
            display: flex;
            padding: 40px 60px;
            gap: 60px;
            background-color: transparent; /* ä¸ŠåŠéƒ¨åˆ†èƒŒæ™¯é€æ˜ */
        }

        .footer-col {
            flex: 1;
        }

        .footer-col.news { flex: 2; } /* Mega News å®½ä¸€ç‚¹ */

        .footer-title {
            font-size: 16px;
            font-weight: bold;
            color: #333;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }

        .footer-title::before {
            content: '';
            display: inline-block;
            width: 4px;
            height: 14px;
            background-color: #e63946;
            margin-right: 8px;
        }

        .footer-text {
            font-size: 13px;
            color: #666;
            line-height: 1.6;
            margin-bottom: 30px;
            text-align: justify;
        }

        .newsletter-box {
            position: relative;
            max-width: 400px;
        }

        .newsletter-box input {
            width: 100%;
            padding: 12px 15px;
            border: none;
            border-radius: 6px;
            background: #fff;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .newsletter-box button {
            position: absolute;
            right: 5px;
            top: 5px;
            border: none;
            background: none;
            cursor: pointer;
            color: #666;
        }

        .cat-list {
            list-style: none;
            padding: 0;
        }

        .cat-list li { margin-bottom: 12px; }

        .cat-list a {
            text-decoration: none;
            color: #555;
            font-size: 13px;
        }

        .social-btn {
            display: inline-flex;
            align-items: center;
            padding: 8px 16px;
            border-radius: 6px;
            color: white;
            text-decoration: none;
            font-size: 13px;
            margin-right: 10px;
            font-weight: 500;
        }

        .bg-insta { background-color: #ff5c8d; }

        .bg-twitter { background-color: #55acee; }

        .footer-bottom {
            background-color: #e8e8e8; /* åº•éƒ¨ç°è‰²æ¡ */
            padding: 15px 60px;
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #888;
        }

        .footer-bottom a {
            color: #888;
            text-decoration: none;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <ul class="nav-links">
            <li><a href="Travel.html">Travel</a></li>
            <li><a href="AI Chat.html">AI Chat</a></li>
            <li><a href="Food.html">Food</a></li>
            <li><a href="Guide.html">Guide</a></li>
            <li><a href="Ticket.html">Ticket</a></li>
            <li><a href="Upload.html" class="active">Upload</a></li>
        </ul>
        <div class="nav-right">
            <div class="search-bar">
                <span>ğŸ”</span>
                <input type="text" placeholder="Search anything">
            </div>
            <div class="user-avatar" id="userAvatar" title="Click to go to Login">User</div>
            <span>ğŸ·ï¸</span>
        </div>
    </nav>

    <section class="hero-section">
        <a href="#" class="hero-card">
            <img src="image\1.png" alt="Moscow">
            <div class="hero-text">
                <h3>Red Square In Moscow</h3>
                <p>Ah, The Joy Of The Open Road...</p>
            </div>
        </a>
        <a href="#" class="hero-card">
            <img src="image\2.png" alt="Night View">
            <div class="hero-text">
                <h3>My Travel To Moscow</h3>
                <p>Download Torrents From Verified...</p>
            </div>
        </a>
        <a href="#" class="hero-card">
            <img src="image\3.png" alt="Couple">
            <div class="hero-text">
                <h3>We Are In Moscow</h3>
                <p>A Single Monitor Manifesto...</p>
            </div>
        </a>
    </section>

    <div class="upload-layout">
        <div class="comments-section">
            <h2 class="section-title">New Comments</h2>

            <!-- ===== Comment upload feature ===== -->
            <div class="comment-form">
                <textarea id="commentText" placeholder="Write a comment..."></textarea>

                <div class="comment-row">
                    <input id="commentFile" type="file" accept="image/*">
                    <button class="comment-btn" id="postCommentBtn">Post</button>
                </div>

                <div class="comment-preview" id="commentPreview">
                    <img id="previewImg" src="" alt="preview">
                </div>

                <div class="comment-hint" id="commentHint"></div>
            </div>

            <!-- New user comments will be inserted here (keeps your existing comments unchanged) -->
            <div id="userComments"></div>

            <div style="margin-bottom: 20px;">
                <h4>Ellsmartx</h4>
                <p style="font-size: 14px; color: #666;">How Nice Does This Look ğŸ˜ I Feel It Should Be Delicious...</p>
            </div>
            <div style="margin-bottom: 20px;">
                <h4>Cassia</h4>
                <p style="font-size: 14px; color: #666;">Take A Rest, I'll Be Cheer Up You Again...</p>
            </div>
            <div style="margin-bottom: 20px;">
                <h4>Amanda</h4>
                <p style="font-size: 14px; color: #666;">You Were Stunning Today, Jan! ğŸ’— Great Match ğŸ‘ğŸ‘</p>
            </div>
            <div style="margin-bottom: 20px;">
                <h4>Denis Simonassi</h4>
                <p style="font-size: 14px; color: #666;">It Was A Great Match Today Janzi! You Did GreatğŸ˜‰ğŸ‡©ğŸ‡ª</p>
            </div>
        </div>

        <div class="instagram-section">
            <!-- ===== Requirement: title clickable like Travel (go to middle page) ===== -->
            <h2 class="section-title">
                <a href="middle.html?topic=instagram">Follow On Instagram</a>
            </h2>

            <!-- ===== Requirement: images clickable (go to details page) ===== -->
            <div class="insta-grid">
                <a href="details.html?topic=instagram&id=ig1" class="insta-item"><img src="https://images.unsplash.com/photo-1617788138017-80ad40651399?w=300" alt="Car"></a>
                <a href="details.html?topic=instagram&id=ig2" class="insta-item"><img src="https://images.unsplash.com/photo-1517849845537-4d257902454a?w=300" alt="Pug"></a>
                <a href="details.html?topic=instagram&id=ig3" class="insta-item"><img src="https://images.unsplash.com/photo-1563245372-f21724e3856d?w=300" alt="Neon"></a>
                <a href="details.html?topic=instagram&id=ig4" class="insta-item"><img src="https://images.unsplash.com/photo-1565958011703-44f9829ba187?w=300" alt="Food"></a>
                <a href="details.html?topic=instagram&id=ig5" class="insta-item"><img src="https://images.unsplash.com/photo-1505740420928-5e560c06d30e?w=300" alt="Headphone"></a>
                <a href="details.html?topic=instagram&id=ig6" class="insta-item"><img src="https://images.unsplash.com/photo-1516035069371-29a1b244cc32?w=300" alt="Dance"></a>
                <a href="details.html?topic=instagram&id=ig7" class="insta-item"><img src="https://images.unsplash.com/photo-1583511655857-d19b40a7a54e?w=300" alt="Dog"></a>
                <a href="details.html?topic=instagram&id=ig8" class="insta-item"><img src="https://images.unsplash.com/photo-1555685812-4b943f1cb0eb?w=300" alt="Neon"></a>
                <a href="details.html?topic=instagram&id=ig9" class="insta-item"><img src="https://images.unsplash.com/photo-1599058945522-28d584b6f0ff?w=300" alt="Boxer"></a>
            </div>
        </div>
    </div>

    <div class="footer-wrapper">
        <div class="footer-main">
            <div class="footer-col news">
                <h3 class="footer-title">Mega News</h3>
                <p class="footer-text">
                    Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Egestas purus viverra accumsan in nisl nisi. Arcu cursus vitae congue mauris rhoncus aenean vel elit scelerisque. In egestas erat imperdiet sed euismod nisi porta lorem mollis. Morbi tristique senectus et netus. Mattis pell.
                </p>
                <h3 class="footer-title">Newsletters</h3>
                <div class="newsletter-box">
                    <input type="email" placeholder="Write Your Email ..">
                    <button>âœ‰ï¸</button>
                </div>
            </div>

            <div class="footer-col">
                <h3 class="footer-title">Categories</h3>
                <ul class="cat-list">
                    <li><a href="#">Culture</a></li>
                    <li><a href="#">Fashion</a></li>
                    <li><a href="#">Featured</a></li>
                    <li><a href="#">Food</a></li>
                    <li><a href="#">Healthy Living</a></li>
                    <li><a href="#">Technology</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h3 class="footer-title">Social Network</h3>
                <div style="display: flex;">
                    <a href="#" class="social-btn bg-insta">ğŸ“· Instagram</a>
                    <a href="#" class="social-btn bg-twitter">ğŸ¦ Twitter</a>
                </div>
            </div>
        </div>

        <div class="footer-bottom">
            <div>
                <a href="#">Privacy Policy</a> | <a href="#">Terms & Conditions</a>
            </div>
            <div>
                All Copyright (C) 2022 Reserved
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function(){
            /* ===== Same as Travel: user avatar shows phone and is clickable ===== */
            const userAvatar = document.getElementById('userAvatar');

            function getCurrentUserPhone(){
                const candidates = [
                    localStorage.getItem('travelAgentCurrentUser'),
                    localStorage.getItem('travelAgentCurrentPhone'),
                    localStorage.getItem('currentUserPhone'),
                    localStorage.getItem('travelAgentLastUser')
                ].filter(Boolean);

                if (candidates.length > 0) return candidates[0];

                try{
                    const users = JSON.parse(localStorage.getItem('travelAgentUsers') || '{}');
                    const keys = Object.keys(users);
                    if (keys.length === 1) return keys[0];
                }catch(e){}

                return '';
            }

            const phone = getCurrentUserPhone();
            userAvatar.textContent = phone ? phone : 'User';
            userAvatar.addEventListener('click', function(){
                window.location.href = 'index.html';
            });

            /* ===== Comment upload feature (localStorage) ===== */
            const STORAGE_KEY = 'travelAgentUploadComments';
            const userCommentsEl = document.getElementById('userComments');

            const commentText = document.getElementById('commentText');
            const commentFile = document.getElementById('commentFile');
            const postBtn = document.getElementById('postCommentBtn');

            const hint = document.getElementById('commentHint');
            const previewWrap = document.getElementById('commentPreview');
            const previewImg = document.getElementById('previewImg');

            let pendingImageDataUrl = '';

            function showHint(msg){
                hint.textContent = msg;
                hint.style.display = msg ? 'block' : 'none';
            }

            function escapeHtml(s){
                return String(s || '')
                    .replaceAll('&', '&amp;')
                    .replaceAll('<', '&lt;')
                    .replaceAll('>', '&gt;')
                    .replaceAll('"', '&quot;')
                    .replaceAll("'", '&#039;');
            }

            function loadSavedComments(){
                try{
                    const arr = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
                    if (!Array.isArray(arr)) return [];
                    return arr;
                }catch(e){
                    return [];
                }
            }

            function saveComments(arr){
                try{
                    localStorage.setItem(STORAGE_KEY, JSON.stringify(arr));
                }catch(e){
                    // If storage fails, still allow UI comment but without persistence.
                }
            }

            function renderComments(){
                const arr = loadSavedComments();
                userCommentsEl.innerHTML = arr.map(c => {
                    const name = escapeHtml(c.name || 'User');
                    const text = escapeHtml(c.text || '');
                    const time = escapeHtml(c.time || '');
                    const img = c.img ? `<div style="margin-top:10px;"><img src="${c.img}" alt="comment image" style="width:100%;max-height:220px;object-fit:cover;border-radius:12px;display:block;"></div>` : '';
                    return `
                        <div style="margin-bottom: 20px;">
                            <h4 style="margin:0 0 6px 0;">${name} <span style="font-weight:400;color:#999;font-size:12px;">${time}</span></h4>
                            <p style="font-size: 14px; color: #666; margin:0;">${text}</p>
                            ${img}
                        </div>
                    `;
                }).join('');
            }

            renderComments();

            commentFile.addEventListener('change', function(){
                showHint('');
                pendingImageDataUrl = '';
                previewWrap.style.display = 'none';
                previewImg.src = '';

                const file = commentFile.files && commentFile.files[0];
                if (!file) return;

                if (!file.type || !file.type.startsWith('image/')){
                    commentFile.value = '';
                    showHint('Please upload an image file.');
                    return;
                }

                const reader = new FileReader();
                reader.onload = function(){
                    pendingImageDataUrl = String(reader.result || '');
                    previewImg.src = pendingImageDataUrl;
                    previewWrap.style.display = 'block';
                };
                reader.onerror = function(){
                    commentFile.value = '';
                    showHint('Feature under development.');
                };
                reader.readAsDataURL(file);
            });

            postBtn.addEventListener('click', function(){
                showHint('');

                const text = (commentText.value || '').trim();
                if (!text){
                    showHint('Please write something before posting.');
                    return;
                }

                const name = phone ? phone : 'User';
                const now = new Date();
                const time = now.toLocaleString();

                const arr = loadSavedComments();
                arr.unshift({
                    name,
                    text,
                    time,
                    img: pendingImageDataUrl || ''
                });
                saveComments(arr);
                renderComments();

                // reset
                commentText.value = '';
                commentFile.value = '';
                pendingImageDataUrl = '';
                previewWrap.style.display = 'none';
                previewImg.src = '';
            });
        });
    </script>
</body>
</html>
